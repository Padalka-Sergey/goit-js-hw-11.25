{"version":3,"file":"index.js","sources":["../src/js/image-api.js","../src/js/index.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '31316386-df3d7a07dab36b9800dfb8d2b';\nconst PARAMS =\n  '&image_type=photo&orientation=horisontal&savesearch=true&per_page=40';\naxios.defaults.baseURL = 'https://pixabay.com/api/';\naxios.defaults.headers.post['Content-Type'] = 'application/json';\n\nfunction fetchFotos(query, page) {\n  return axios\n    .get(`?key=${API_KEY}&q=${query}${PARAMS}&page=${page}`)\n    .then(({ data }) => data);\n}\n\nexport { fetchFotos };\n","import { fetchFotos } from './image-api';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n// import throttle from 'lodash.throttle';\n\nconst ref = {\n  form: document.querySelector('#search-form'),\n  galery: document.querySelector('.gallery'),\n  loadMore: document.querySelector('.load-more'),\n};\n\nlet searchQuery = null;\nlet page = 1;\nlet gallery = null;\n\nref.form.addEventListener('submit', onSubmit);\nref.loadMore.addEventListener('click', onClckloadMore);\nref.galery.addEventListener('click', onClckLinkImg);\n\nfunction onSubmit(evt) {\n  evt.preventDefault();\n  const form = evt.target;\n  searchQuery = form.elements.searchQuery.value;\n  page = 1;\n\n  delMarkup();\n  delLoadMore();\n\n  if (searchQuery === '') {\n    Notiflix.Notify.failure('Please fill in all the fields!');\n    return;\n  }\n\n  fetchFotos(searchQuery, page)\n    .then(({ hits, totalHits }) => {\n      if (hits.length === 0) {\n        Notiflix.Notify.failure(\n          'Sorry, there are no images matching your search query. Please try again.'\n        );\n        return;\n      }\n      Notiflix.Notify.success(`Hooray! We found ${totalHits} images.`);\n      showLoadMore(hits, totalHits, page);\n      makeMarkup(hits);\n\n      page += 1;\n    })\n    .catch(error => {\n      console.log(error);\n    });\n}\n\nfunction onClckloadMore() {\n  fetchFotos(searchQuery, page)\n    .then(({ hits, totalHits }) => {\n      showLoadMore(hits, totalHits, page);\n      makeMarkup(hits);\n      if (gallery) {\n        gallery.refresh();\n      }\n      makeLowScroll();\n      page += 1;\n    })\n    .catch(error => {\n      console.log(error);\n    });\n}\n\nfunction makeMarkup(dataResp) {\n  const markup = dataResp\n    .map(\n      dataEl => `<a href=${dataEl.largeImageURL} class=\"large-image\"><div class=\"photo-card\">\n  <img src=${dataEl.webformatURL} alt=${dataEl.tags} loading=\"lazy\" />\n  <div class=\"info\">\n    <p class=\"info-item\">\n      <b>Likes</b> ${dataEl.likes}\n    </p>\n    <p class=\"info-item\">\n      <b>Views</b> ${dataEl.views}\n    </p>\n    <p class=\"info-item\">\n      <b>Comments</b> ${dataEl.comments}\n    </p>\n    <p class=\"info-item\">\n      <b>Downloads</b> ${dataEl.downloads}\n    </p>\n  </div>\n</div></a>`\n    )\n    .join('');\n  ref.galery.insertAdjacentHTML('beforeend', markup);\n}\n\nfunction showLoadMore(hits, totalHits, page) {\n  if (hits.length % 40 === 0 && hits.length * page < totalHits) {\n    return ref.loadMore.classList.add('load-more-visible');\n  }\n  ref.loadMore.classList.remove('load-more-visible');\n\n  Notiflix.Notify.failure(\n    \"We're sorry, but you've reached the end of search results.\"\n  );\n}\n\nfunction delMarkup() {\n  ref.galery.innerHTML = '';\n}\n\nfunction delLoadMore() {\n  if (ref.loadMore.classList.contains('load-more-visible')) {\n    ref.loadMore.classList.remove('load-more-visible');\n  }\n}\n\nfunction onClckLinkImg(evt) {\n  evt.preventDefault();\n\n  gallery = new SimpleLightbox('.gallery a');\n}\n\nfunction makeLowScroll() {\n  const { height } = ref.galery.firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: height * 2,\n    behavior: 'smooth',\n  });\n}\n\n// Бесконечный скролл  =======================\n\n// window.addEventListener(\n//   'scroll',\n//   throttle(() => {\n//     throttleScroll();\n//   }, 250)\n// );\n\n// function throttleScroll() {\n//   console.log('Scroll');\n\n//   const { scrollHeight, scrollTop, clientHeight } = document.documentElement;\n\n//   if (scrollTop >= scrollHeight - clientHeight - 1000) {\n//     onClckloadMore();\n//   }\n// }\n\n// ================================================\n"],"names":["API_KEY","PARAMS","axios","fetchFotos","query","page","data","ref","searchQuery","gallery","onSubmit","onClckloadMore","onClckLinkImg","evt","delMarkup","delLoadMore","hits","totalHits","showLoadMore","makeMarkup","error","makeLowScroll","dataResp","markup","dataEl","SimpleLightbox","height"],"mappings":"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"}